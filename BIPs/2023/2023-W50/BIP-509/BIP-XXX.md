# BIP-XXX: Wire Up Batch Relayer V6

## TL;DR

More than six months after [BIP-216](https://forum.balancer.fi/t/bip-216-add-permissions-for-batch-relayer-v5-second-attempt/4534) (batch relayer v5), the last day of October saw the deployment of the newest batch relayer: v6 ([changelog](https://forum.balancer.fi/t/bip-216-add-permissions-for-batch-relayer-v5-second-attempt/4534)).

This BIP proposes to give it the necessary permissions on all chains it was deployed on, except for BSC and the testnets.

## Specification

Payloads were generated by passing [this config](https://github.com/BalancerMaxis/multisig-ops/blob/df1a2cf41d75aa9fd11c33ae673b222ce42c651c/BIPs/00batched/2023-W47/BIP-XXX/2023-11-21.json) to [the same script](https://github.com/BalancerMaxis/multisig-ops/blob/df1a2cf41d75aa9fd11c33ae673b222ce42c651c/action-scripts/gen_add_permissions_payload.py) as for BIP-216.

Here is a detailed overview of the permissions that are being granted to the relayer:

| function                                                                                                            | description                                                                                                                                                                                                                                                  |
| :------------------------------------------------------------------------------------------------------------------ | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `exitPool(bytes32,address,address,(address[],uint256[],bytes,bool))`                                                | Allow a relayer to remove liquidity from a pool on the user's behalf. [Relayer permissions notes](https://github.com/BalancerMaxis/multisig-ops/blob/main/docs/Authorizer/vault_permissions.md)                                                              |
| `joinPool(bytes32,address,address,(address[],uint256[],bytes,bool))`                                                | Allow a relayer to add liquidity to a pool on the user's behalf. [Relayer permissions notes](https://github.com/BalancerMaxis/multisig-ops/blob/main/docs/Authorizer/vault_permissions.md)                                                                   |
| `batchSwap(uint8,(bytes32,uint256,uint256,uint256,bytes)[],address[],(address,bool,address,bool),int256[],uint256)` | Allow a relayer to make a multihop trade or source liquidity from multiple pools on a users behalf. [Relayer permissions notes](https://github.com/BalancerMaxis/multisig-ops/blob/main/docs/Authorizer/vault_permissions.md)                                |
| `manageUserBalance((uint8,address,uint256,address,address)[])`                                                      | Utilize existing Vault allowances and internal balances so that a user does not have to re-approve the new relayer for each token. [Relayer permissions notes](https://github.com/BalancerMaxis/multisig-ops/blob/main/docs/Authorizer/vault_permissions.md) |
| `setRelayerApproval(address,address,bool)`                                                                          | Approve the relayer on the user's behalf (user must still provide a signed message). [Relayer permissions notes](https://github.com/BalancerMaxis/multisig-ops/blob/main/docs/Authorizer/vault_permissions.md)                                               |
| `swap((bytes32,uint8,address,address,uint256,bytes),(address,bool,address,bool),uint256,uint256)`                   | Allow a relayer to trade within a single pool on the user's behalf. [Relayer permissions notes](https://github.com/BalancerMaxis/multisig-ops/blob/main/docs/Authorizer/vault_permissions.md)                                                                |

More output files can be found in this dir: [BIPS/00batched/2023-W47/BIP-XXX/](https://github.com/BalancerMaxis/multisig-ops/tree/df1a2cf41d75aa9fd11c33ae673b222ce42c651c/BIPs/00batched/2023-W47/BIP-XXX)
